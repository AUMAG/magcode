(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     44994,       1223]
NotebookOptionsPosition[     42113,       1124]
NotebookOutlinePosition[     42510,       1142]
CellTagsIndexPosition[     42467,       1139]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 StyleBox[
  RowBox[{"SetDirectory", "@", 
   RowBox[{"NotebookDirectory", "[", "]"}]}],
  InitializationCell->True], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"<<", "\"\<MagnetCode`\>\""}],
  InitializationCell->True]}], "Input"],

Cell[BoxData["\<\"/Users/will/magcode/mathematica\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"mm", ":=", "0.001"}], "\[IndentingNewLine]", 
 RowBox[{"tesla", ":=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"amps", ":=", "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ohms", ":=", "1"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"magnet", "=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MagnetRadius", "\[Rule]", 
     RowBox[{"5", "mm"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"MagnetLength", "\[Rule]", 
     RowBox[{"10", "mm"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Magnetisation", "\[Rule]", 
     RowBox[{"1", " ", "tesla"}]}]}], "\[IndentingNewLine]", 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"coil", "=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CoilRadius", "\[Rule]", 
     RowBox[{"7", "mm"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"CoilLength", "\[Rule]", 
     RowBox[{"20", "mm"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Current", "\[Rule]", 
     RowBox[{"1", " ", "amps"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"WireRadius", "\[Rule]", 
     RowBox[{"0.1", "mm"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"WireCoating", "\[Rule]", 
     RowBox[{"0.01", "mm"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"CoilResistance", "\[Rule]", 
     RowBox[{"8", "ohms"}]}]}], "\[IndentingNewLine]", 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalculateCoilParams", "[", "parameters__", "]"}], " ", ":=", " ", 
   "\n", "  ", 
   RowBox[{"ReleaseHold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "\n", "               ", 
       RowBox[{
        RowBox[{
         RowBox[{"Hold", "@", 
          RowBox[{"Symbol", "[", "\"\<CoilRadius\>\"", "]"}]}], "->", 
         "CoilRadius"}], ",", "\n", "               ", 
        RowBox[{
         RowBox[{"Hold", "@", 
          RowBox[{"Symbol", "[", "\"\<CoilThickness\>\"", "]"}]}], "->", 
         "CoilThickness"}], ",", "\n", "               ", 
        RowBox[{
         RowBox[{"Hold", "@", 
          RowBox[{"Symbol", "[", "\"\<CoilTurns\>\"", "]"}]}], "->", 
         "TotalTurns"}], ",", "\n", "               ", 
        RowBox[{
         RowBox[{"Hold", "@", 
          RowBox[{"Symbol", "[", "\"\<CoilLength\>\"", "]"}]}], "->", 
         "CoilLength"}], ",", "\n", "               ", 
        RowBox[{
         RowBox[{"Hold", "@", 
          RowBox[{"Symbol", "[", "\"\<Current\>\"", "]"}]}], "->", 
         "Current"}]}], "\n", "              ", "}"}], " ", "//.", " ", "\n", 
      "  ", 
      RowBox[{"Flatten", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "\n", "    ", 
          RowBox[{
           RowBox[{"CoilThickness", " ", "\[Rule]", " ", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{"2", " ", "WireLength", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"WireRadius", "+", "WireCoating"}], ")"}], "^", 
                "2"}]}], " ", ")"}], " ", "/", "\n", 
             "                                ", 
             RowBox[{"(", "  ", 
              RowBox[{"\[Pi]", " ", "CoilLength", " ", 
               RowBox[{"(", 
                RowBox[{"CoilRadius", "+", "WireRadius", "+", "WireCoating"}],
                 ")"}]}], " ", ")"}]}]}], " ", ",", "\n", "    ", 
           RowBox[{"WireLength", " ", "->", " ", 
            RowBox[{"CoilResistance", " ", 
             RowBox[{"WireArea", " ", "/", " ", "WireResistivity"}]}]}], " ", 
           ",", "\n", "    ", 
           RowBox[{"WireResistivity", " ", "->", " ", 
            RowBox[{"1.7", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "8"}]}]}]}], ",", " ", 
           RowBox[{"(*", " ", "copper", " ", "*)"}], "\n", "    ", 
           RowBox[{"WireArea", " ", "->", " ", 
            RowBox[{"\[Pi]", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"WireRadius", "+", "WireCoating"}], ")"}], "^", 
              "2"}]}]}], ",", "\n", "    ", 
           RowBox[{"TotalTurns", " ", "->", " ", 
            RowBox[{"TurnsZ", " ", "TurnsR"}]}], ",", "\n", "    ", 
           RowBox[{"TurnsZ", " ", "->", " ", 
            RowBox[{"Round", "[", 
             RowBox[{"CoilLength", " ", "/", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "WireRadius"}], "+", 
                RowBox[{"2", "WireCoating"}]}], ")"}]}], "]"}]}], ",", "\n", 
           "    ", 
           RowBox[{"TurnsR", " ", "->", " ", 
            RowBox[{"Round", "[", 
             RowBox[{"CoilThickness", " ", "/", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "WireRadius"}], "+", 
                RowBox[{"2", "WireCoating"}]}], ")"}]}], "]"}]}]}], "\n", 
          "    ", "}"}], ",", "parameters"}], "}"}]}]}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cm", "->", "0.01"}], ",", 
       RowBox[{"mm", "->", "0.001"}], ",", 
       RowBox[{"volts", "->", "1"}], ",", 
       RowBox[{"ohms", "->", "1"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"CalculateCoilParams", "[", "coil", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"MagnetRadius", "\[Rule]", "0.005`"}], ",", 
   RowBox[{"MagnetLength", "\[Rule]", "0.01`"}], ",", 
   RowBox[{"Magnetisation", "\[Rule]", "1"}]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"CoilRadius", "\[Rule]", "0.007`"}], ",", 
   RowBox[{"CoilLength", "\[Rule]", "0.02`"}], ",", 
   RowBox[{"Current", "\[Rule]", "1"}], ",", 
   RowBox[{"WireRadius", "\[Rule]", "0.0001`"}], ",", 
   RowBox[{"WireCoating", "\[Rule]", "0.00001`"}], ",", 
   RowBox[{"CoilResistance", "\[Rule]", "8"}]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"CoilRadius", "\[Rule]", "0.007`"}], ",", 
   RowBox[{"CoilThickness", "\[Rule]", "0.0009690411185571277`"}], ",", 
   RowBox[{"CoilTurns", "\[Rule]", "364"}], ",", 
   RowBox[{"CoilLength", "\[Rule]", "0.02`"}], ",", 
   RowBox[{"Current", "\[Rule]", "1"}]}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Comparison between different methods\
\>", "Section"],

Cell["\<\
Here we hope that a zero-thickness coil and a thin-thickness coil gives \
similar results.
Eccentricity should result in only small changes in force.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"thinvthickparams", "=", 
   RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MagnetRadius", "\[Rule]", 
      RowBox[{"9", "mm"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"MagnetLength", "\[Rule]", 
      RowBox[{"10", "mm"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Magnetisation", "\[Rule]", 
      RowBox[{"1", " ", "tesla"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"CoilRadius", "\[Rule]", 
      RowBox[{"10", "mm"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"CoilLength", "\[Rule]", 
      RowBox[{"20", "mm"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"CoilTurns", "\[Rule]", "400"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Current", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Displacement", "\[Rule]", 
      RowBox[{"10", "mm"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"IntegrationPrecision", "\[Rule]", "3"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Zero thickness coil:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Timing", "@", 
   RowBox[{"MagnetCoilForce", "@", 
    RowBox[{"{", "thinvthickparams", "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Low thickness coil: (two numerical integrals; two orders of magnitude \
slower)\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Timing", "@", 
   RowBox[{"MagnetCoilForce", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"thinvthickparams", ",", "\[IndentingNewLine]", 
      RowBox[{"CoilThickness", "\[Rule]", 
       RowBox[{"0.1", "mm"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Low thickness coil with small eccentricity: (three numerical \
integrals)\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "@", 
  RowBox[{"MagnetCoilForce", "@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"thinvthickparams", ",", "\[IndentingNewLine]", 
     RowBox[{"CoilThickness", "\[Rule]", 
      RowBox[{"0.1", "mm"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Eccentricity", "\[Rule]", 
      RowBox[{"0.1", "mm"}]}]}], "\[IndentingNewLine]", "}"}]}]}]}], "Input"],

Cell[BoxData["\<\"Zero thickness coil:\"\>"], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0005269999999768515`", ",", 
   RowBox[{"-", "2.601283426134134`"}]}], "}"}]], "Output"],

Cell[BoxData["\<\"Low thickness coil: (two numerical integrals; two orders of \
magnitude slower)\"\>"], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.018071999999961008`", ",", 
   RowBox[{"-", "2.5861287194187934`"}]}], "}"}]], "Output"],

Cell[BoxData["\<\"Low thickness coil with small eccentricity: (three \
numerical integrals)\"\>"], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.18814499999996315`", ",", "2.53075857109329`"}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Comparison with the filament model", "Section"],

Cell[CellGroupData[{

Cell["Thin coil", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"filamentparams", "=", 
   RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MagnetRadius", "\[Rule]", 
      RowBox[{"9", "mm"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"MagnetLength", "\[Rule]", 
      RowBox[{"10", "mm"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Turn", " ", "the", " ", "magnet", " ", "into", " ", "a", " ", 
       RowBox[{"coil", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Magnetisation", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MagnetCurrent", "->", 
      RowBox[{"Magnetisation", " ", 
       RowBox[{"MagnetLength", "/", 
        RowBox[{"(", 
         RowBox[{"4", "\[Pi]", " ", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "7"}], ")"}]}], " ", "CoilTurns"}], ")"}]}]}]}], ",",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"CoilRadius", "\[Rule]", 
      RowBox[{"10", "mm"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"CoilLength", "\[Rule]", 
      RowBox[{"20", "mm"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"CoilTurns", "\[Rule]", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Current", "\[Rule]", "1"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FilamentForce", "[", 
    RowBox[{"r_", ",", "R_", ",", "z_"}], "]"}], "=", 
   RowBox[{"z", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"r", "+", "R"}], ")"}], "2"], "+", 
          SuperscriptBox["z", "2"]}]]], " ", 
       RowBox[{"EllipticK", "[", 
        FractionBox[
         RowBox[{"4", " ", "r", " ", "R"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"r", "+", "R"}], ")"}], "2"], "+", 
          SuperscriptBox["z", "2"]}]], "]"}]}], "-", 
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r", "2"], "+", 
          SuperscriptBox["R", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"r", "-", "R"}], ")"}], "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"r", "+", "R"}], ")"}], "2"], "+", 
           SuperscriptBox["z", "2"]}]]}]], " ", 
       RowBox[{"EllipticE", "[", 
        FractionBox[
         RowBox[{"4", " ", "r", " ", "R"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"r", "+", "R"}], ")"}], "2"], "+", 
          SuperscriptBox["z", "2"]}]], "]"}]}]}], ")"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ThinCoilForceFilaments", "[", "pp__", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Hold", "[", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f1", ",", "f2"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f1", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "CoilLength"}], "/", "2"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], " ", 
             RowBox[{"CoilLength", "/", 
              RowBox[{"(", 
               RowBox[{"CoilTurns", "-", "1"}], ")"}]}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "CoilTurns"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"f2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "MagnetLength"}], "/", "2"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], " ", 
             RowBox[{"MagnetLength", "/", 
              RowBox[{"(", 
               RowBox[{"CoilTurns", "-", "1"}], ")"}]}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "CoilTurns"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"4", "\[Pi]", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "7"}], ")"}]}], "Current", " ", "MagnetCurrent", " ", 
         
         RowBox[{"Sum", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"FilamentForce", "[", 
            RowBox[{"CoilRadius", ",", "MagnetRadius", ",", 
             RowBox[{"Displacement", "+", "z1", "+", "z2"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"z1", ",", "f1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"z2", ",", "f2"}], "}"}]}], "\[IndentingNewLine]", 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "]"}], "//.", "pp"}], "//",
    "ReleaseHold"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ThinCoilForceFilaments", "@", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Displacement", "\[Rule]", 
       RowBox[{"10", "mm"}]}], ",", "filamentparams"}], "}"}]}]}], "//.", 
  "filamentparams"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MagnetCoilForce", "@", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Displacement", "\[Rule]", 
       RowBox[{"10", "mm"}]}], ",", "filamentparams"}], "}"}]}]}], "//.", 
  "filamentparams"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MagnetCoilForce", "@", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Displacement", "\[Rule]", 
       RowBox[{"10", "mm"}]}], ",", 
      RowBox[{"CoilThickness", "\[Rule]", 
       RowBox[{"0.1", "mm"}]}], ",", "filamentparams"}], "}"}]}]}], "//.", 
  "filamentparams"}]}], "Input"],

Cell[BoxData[
 RowBox[{"-", "0.641206730946193`"}]], "Output"],

Cell[BoxData[
 RowBox[{"-", "0.6503208565335336`"}]], "Output"],

Cell[BoxData[
 RowBox[{"-", "0.6465272144934819`"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "@", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ThinCoilForceFilaments", "@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Displacement", "\[Rule]", "x"}], ",", "filamentparams"}], 
          "}"}]}]}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"50", "mm"}]}], "}"}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "10"}], ",", 
      RowBox[{"MaxRecursion", "\[Rule]", "2"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"MagnetCoilForce", "@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Displacement", "\[Rule]", "x"}], ",", "filamentparams"}],
            "}"}]}]}], ")"}], "//.", "filamentparams"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"50", "mm"}]}], "}"}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "10"}], ",", 
      RowBox[{"MaxRecursion", "\[Rule]", "2"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"MagnetCoilForce", "@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Displacement", "\[Rule]", "x"}], ",", 
            RowBox[{"CoilThickness", "\[Rule]", 
             RowBox[{"0.1", "mm"}]}], ",", "filamentparams"}], "}"}]}]}], 
        ")"}], "//.", "filamentparams"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"50", "mm"}]}], "}"}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "10"}], ",", 
      RowBox[{"MaxRecursion", "\[Rule]", "2"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "Green"}]}], "]"}]}], 
   "\[IndentingNewLine]", "}"}]}]], "Input"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {RGBColor[1, 0, 0], LineBox[CompressedData["
1:eJwBYQKe/SFib1JlAgAAACUAAAACAAAAzpvg3mXcNz7WVmxl9TaWvkWxZSfv
4lU/wYlzcUu1tL9p9dgr7OJlP72pfOpGxcW/GIn/YTBqcD9KIrQmM9XRv3uX
Eq7q4nU/fMKtehJw2r901RtRd9F7P4QLu6QaFOG/t4kS+gHggD825QtgVVrj
v7Qol0tI14M/WDS6L7hs5L+wxxudjs6GPxWbkBXxduS/Ct5HE4STiT94aa7O
eozjv2X0c4l5WIw/DZfXtdmE4b/ACqD/bh2PP5FMUiDxPdy/jRDmOjLxkD/1
++LnHz7VvyZyyN64TJI//hrBgxFh0L++06qCP6iTP566TYrKy8m/VzWNJsYD
lT8Ju6yiC6DEv/CWb8pMX5Y/WwsD6Y6vwL9uhA8ESNiXP3w3IckBz7q/7HGv
PUNRmT8Q9BEhzL+1v2pfT3c+ypo/Rt7wS9jMsb/pTO+wOUOcP3QRKkf4Xq2/
FvbifAyjnT/JN+/Gx7Wov0Kf1kjfAp8/MKlYtGDqpL84JGUKWTGgP9zj+vIu
zqG/zvhecELhoD+AQjIi5Xqev1eTNyHmn6E/4oxGLm7mmb/gLRDSiV6iP+AM
t5g0Ipa/asjogi0doz+J+RDdMwSTv/NiwTPR26M/I1RqjMlrkL+yKADZ+pak
P7uaQut3kYy/cu4+fiRSpT9V2CRMgfWIvzG0fSNODaY/D2gIM1Tlhb/webzI
d8imPygwsKGgSIO/644FMcB8pz8P2t75XR+Bv+ajTpkIMag/hP4xG6iBfr/h
uJcBUeWoP+fWMnOtQnu/3M3gaZmZqT/hn6ZpjW54v1DSNoE=
      "]]}}, {{}, {}, 
    {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwBYQKe/SFib1JlAgAAACUAAAACAAAAzpvg3mXcNz4A8HkUG9KWvkWxZSfv
4lU/JxXDLtFGtb9p9dgr7OJlP4fSW25TYca/GIn/YTBqcD8tupR581jSv3uX
Eq7q4nU/GHNhaGck27901RtRd9F7P/EnGLKGcOG/t4kS+gHggD92hk6fX7Lj
v7Qol0tI14M/G0VkzIe65L+wxxudjs6GP1MTawiXsuS/Ct5HE4STiT8HDKZY
mKzjv2X0c4l5WIw/KnOR4zd54b/ACqD/bh2PP26ZOvS2zNu/jRDmOjLxkD/t
gtK29efUvyZyyN64TJI/FqBFUkso0L++06qCP6iTPxMsKWryfMm/VzWNJsYD
lT+FKiqKCmfEv/CWb8pMX5Y/vKteWjSFwL9uhA8ESNiXP0m2iRNMkLq/7HGv
PUNRmT/yk3PdmJC1v2pfT3c+ypo/Arbw/Nqosb/pTO+wOUOcPys/WMV+J62/
FvbifAyjnT805HGI6Imov0Kf1kjfAp8/OevLJG3HpL84JGUKWTGgP6holEQm
sqG/zvhecELhoD9+CTMro02ev1eTNyHmn6E/gCk5uU3Cmb/gLRDSiV6iPxbf
kV0sBZa/asjogi0doz/v+fTjuOySv/NiwTPR26M/KoUJSK5YkL+yKADZ+pak
P+iyMycUcoy/cu4+fiRSpT8fGJS+lNuIvzG0fSNODaY/DV9Z4M7Phb/webzI
d8imP7kCwmysNoO/644FMcB8pz/hyueZOBCBv+ajTpkIMag/S2jPkP5nfr/h
uJcBUeWoP8qy43HZLHu/3M3gaZmZqT9MQs3V6Vt4v4vXMps=
      "]]}}, {{}, {}, 
    {RGBColor[0, 1, 0], LineBox[CompressedData["
1:eJwBYQKe/SFib1JlAgAAACUAAAACAAAAzpvg3mXcNz5OfRXNTN2WvkWxZSfv
4lU/Jz1OQ+VQtb9p9dgr7OJlPwskXh7eZsa/GIn/YTBqcD9FQ1gptVPSv3uX
Eq7q4nU/o4c9hSL82r901RtRd9F7P+b3OB6EZOG/t4kS+gHggD+4OiK2GZHj
v7Qol0tI14M/X2/qzt+b5L+wxxudjs6GP59t1R3CkuS/Ct5HE4STiT9zGg2D
IY/jv2X0c4l5WIw/TXmdFMZe4b/ACqD/bh2PP7Y9R2Dnt9u/jRDmOjLxkD8S
egVb1/HUvyZyyN64TJI/DNsQAdM10L++06qCP6iTP1ohjBK/l8m/VzWNJsYD
lT8g52hauX/Ev/CWb8pMX5Y/0AIBZVSbwL9uhA8ESNiXP83MeCYMt7q/7HGv
PUNRmT80xzvNSbK1v2pfT3c+ypo/kLHeAA3Gsb/pTO+wOUOcP1b/MZEJWq2/
FvbifAyjnT+que/qFraov0Kf1kjfAp8/hUNTrBXupL84JGUKWTGgPzZ6jqEG
1KG/zvhecELhoD+SBp69Homev1eTNyHmn6E/6UFHZhX2mb/gLRDSiV6iP5WF
BcFeMpa/asjogi0doz+aaa36SBSTv/NiwTPR26M/GUbfuWl7kL+yKADZ+pak
P7UAc7Fhr4y/cu4+fiRSpT8QMfqj1RGJvzG0fSNODaY/XM47GPX/hb/webzI
d8imP5BJ0O2FYYO/644FMcB8pz/MiPSnnTaBv+ajTpkIMag/KQG36fesfr/h
uJcBUeWoP3OsUlnzanu/3M3gaZmZqT/UKfql9JN4vx+BMZE=
      "]]}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  ImageSize->{341., Automatic},
  PlotRange->{{0, 0.05}, {-0.6395192547978207, 0.}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Thick coil", "Subsection"],

Cell[BoxData[
 RowBox[{"thickfilamentparams", ":=", 
  RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Displacement", "\[Rule]", 
     RowBox[{"10", "mm"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"MagnetRadius", "\[Rule]", 
     RowBox[{"9", "mm"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"MagnetLength", "\[Rule]", 
     RowBox[{"10", "mm"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Turn", " ", "the", " ", "magnet", " ", "into", " ", "a", " ", 
      RowBox[{"coil", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"MagnetCurrent", "\[Rule]", 
     RowBox[{"Magnetisation", " ", 
      RowBox[{"MagnetLength", "/", 
       RowBox[{"(", 
        RowBox[{"4", "\[Pi]", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "7"}], ")"}]}], " ", "CoilTurns"}], ")"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Magnetisation", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"CoilRadius", "\[Rule]", 
     RowBox[{"10", "mm"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"CoilLength", "\[Rule]", 
     RowBox[{"20", "mm"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"CoilThickness", "\[Rule]", 
     RowBox[{"5", "mm"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"CoilTurns", "->", 
     RowBox[{"CoilTurnsR", " ", "CoilTurnsZ"}]}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"CoilTurnsR", "\[Rule]", "5"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CoilTurnsZ", "\[Rule]", "20"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Current", "\[Rule]", "1"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "}"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ThickCoilForceFilaments", "[", "pp__", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Hold", "[", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fr", ",", "f1", ",", "f2"}], "}"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fr", "=", 
          RowBox[{"CoilRadius", "+", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}], " ", 
              RowBox[{
               RowBox[{"(", "CoilThickness", ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"CoilTurnsR", "-", "1"}], ")"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", "CoilTurnsR"}], "}"}]}], "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"f1", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "CoilLength"}], "/", "2"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}], " ", 
              RowBox[{"CoilLength", "/", 
               RowBox[{"(", 
                RowBox[{"CoilTurnsZ", "-", "1"}], ")"}]}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", "CoilTurnsZ"}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"f2", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "MagnetLength"}], "/", "2"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}], " ", 
              RowBox[{"MagnetLength", "/", 
               RowBox[{"(", 
                RowBox[{"CoilTurns", "-", "1"}], ")"}]}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", "CoilTurns"}], " ", "}"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"4", "\[Pi]", " ", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "7"}], ")"}]}], "Current", " ", "MagnetCurrent", " ", 
          RowBox[{"Sum", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FilamentForce", "[", 
             RowBox[{"rr", ",", "MagnetRadius", ",", 
              RowBox[{"Displacement", "+", "z1", "+", "z2"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"rr", ",", "fr"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z1", ",", "f1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z2", ",", "f2"}], "}"}]}], "\[IndentingNewLine]", 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "]"}], "//.", "pp"}], "//",
     "ReleaseHold"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ThickCoilForceShell", "[", "pp__", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Hold", "[", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "fr", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fr", "=", 
          RowBox[{
           RowBox[{"CoilRadius", "+", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Hold", "@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"n", "-", "1"}], ")"}], " ", 
                  RowBox[{
                   RowBox[{"(", "CoilThickness", ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"CoilTurnsR", "-", "1"}], ")"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", "1", ",", "CoilTurnsR"}], "}"}]}], 
                "]"}]}], "//.", "pp"}], ")"}]}], "//", "ReleaseHold"}]}], ";",
          "\[IndentingNewLine]", " ", 
         RowBox[{
          RowBox[{"Sum", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MagnetCoilForce", "@", 
             RowBox[{"Flatten", "@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CoilRadius", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"rr", "//.", "pp"}], ")"}]}], ",", 
                RowBox[{"CoilThickness", "\[Rule]", "0"}], ",", "pp"}], 
               "}"}]}]}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"rr", ",", "fr"}], "}"}]}], "\[IndentingNewLine]", "]"}],
           "/", 
          RowBox[{"(", 
           RowBox[{"CoilTurnsR", "//.", "pp"}], ")"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], "]"}], "//", "ReleaseHold"}], ")"}], "//.",
    "pp"}]}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Zero coil thickness: (filament, shell)\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "@", 
  RowBox[{"ThinCoilForceFilaments", "@", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", "thickfilamentparams", "}"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Timing", "@", 
    RowBox[{"MagnetCoilForce", "@", 
     RowBox[{"Flatten", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CoilThickness", "\[Rule]", 
         RowBox[{"0", "mm"}]}], ",", "thickfilamentparams"}], "}"}]}]}]}], "//.",
    "thickfilamentparams"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Non-zero coil thickness: (filament, shell, integral)\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "@", 
  RowBox[{
  "ThickCoilForceFilaments", "@", 
   "thickfilamentparams"}]}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "@", 
  RowBox[{
  "ThickCoilForceShell", "@", 
   "thickfilamentparams"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Timing", "@", 
   RowBox[{"MagnetCoilForce", "@", "thickfilamentparams"}]}], "//.", 
  "thickfilamentparams"}]}], "Input"],

Cell[BoxData["\<\"Zero coil thickness: (filament, shell)\"\>"], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.3720000000000141`", ",", 
   RowBox[{"-", "0.641206730946193`"}]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0006070000000022446`", ",", 
   RowBox[{"-", "0.6503208565335337`"}]}], "}"}]], "Output"],

Cell[BoxData["\<\"Non-zero coil thickness: (filament, shell, integral)\"\>"], \
"Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.37229100000001836`", ",", 
   RowBox[{"-", "0.47364450499161614`"}]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0026070000000117943`", ",", 
   RowBox[{"-", "0.49766947025856045`"}]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.01330799999999499`", ",", 
   RowBox[{"-", "0.49943960371836393`"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"xmax", ":=", 
  RowBox[{"40", "mm"}]}], "\[IndentingNewLine]", 
 RowBox[{"Show", "@", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ThickCoilForceShell", "[", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Displacement", "\[Rule]", "x"}], ",", 
           "thickfilamentparams"}], "}"}]}], "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "xmax"}], "}"}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "10"}], ",", 
      RowBox[{"MaxRecursion", "\[Rule]", "2"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "Green"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MagnetCoilForce", "[", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Displacement", "\[Rule]", "x"}], ",", 
            "thickfilamentparams"}], "}"}]}], "]"}], "//.", 
        "thickfilamentparams"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "xmax"}], "}"}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "10"}], ",", 
      RowBox[{"MaxRecursion", "\[Rule]", "2"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ThickCoilForceFilaments", "[", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Displacement", "\[Rule]", "x"}], ",", 
           "thickfilamentparams"}], "}"}]}], "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "xmax"}], "}"}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "10"}], ",", 
      RowBox[{"MaxRecursion", "\[Rule]", "2"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], 
   "\[IndentingNewLine]", "}"}]}]}], "Input"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {RGBColor[0, 1, 0], LineBox[CompressedData["
1:eJwBYQKe/SFib1JlAgAAACUAAAACAAAApXyA5bcWMz4A2DtUcxORvp5aUexY
glE/fj0saxR1r7/uXXqJVoJhP6yNXKnG2L+/jQ7MnIBDaj+e7qBfIFvIv5bf
DlhVgnE/nmRJduai0L8qEeNALEF2P/LgrVA3jNW/vkK3KQMAez8oi+y437/Z
v1J0ixLavn8/yscTRJXd3L/z0q992D6CP2h9NEmi5d6/1OSfQgN2hD9Qb1X1
udjfv7b2jwcurYY/sQb2d5vm37+YCIDMWOSIP8RhXqAcEN+/eRpwkYMbiz+M
dPK4b1Pdv6C2QDGOR40//ok2YqzC2r/IUhHRmHOPPw7kpUdWjNe/ePdwuNHP
kD+y0ahXelvUv4xFWQjX5ZE/JR/EcXCL0b/xaQzQbBOTP0EB9QZV4M2/Vo6/
lwJBlD8L4sNVvnzJv7uycl+YbpU/ErY3ZybNxb8g1yUnLpyWP1dGAqGgtMK/
Efgbl6O1lz8oGyXAA0PAvwIZEgcZz5g/tf8FwElbvL/zOQh3juiZP/1/Hzy/
y7i/5Fr+5gMCmz+GtTxG4b61vyZSv84JM5w/Li2nZH3ssr9oSYC2D2SdP/vV
ZiT1hbC/qkBBnhWVnj+yZnn2A/Osv+w3AoYbxp8/1yK6HABxqb8oupmtyHig
P5w/2tbDeqa/W1gymIMOoT/0ufrAueujv472yoI+pKE/pm+ExyG0ob/AlGNt
+TmiPxhWaNazjZ+/vNhqWjPKoj9cWsQnZk+cv7gcckdtWqM/BqUg6xt2mb+0
YHk0p+qjP6WIVhDi85a/sKSAIeF6pD9oEfUQ5byUvz74MNw=
      "]]}}, {{}, {}, 
    {RGBColor[0, 0, 1], LineBox[CompressedData["
1:eJwBYQKe/SFib1JlAgAAACUAAAACAAAApXyA5bcWMz6SZvuVW0iRvp5aUexY
glE/2OtoHqO6r7/uXXqJVoJhP5FlCyB8FsC/jQ7MnIBDaj8EJPX1t43Iv5bf
DlhVgnE/7Z8Seh6u0L8qEeNALEF2P2XuDHepaNW/vkK3KQMAez8CsbBln3vZ
v1J0ixLavn8/BAnqftJk3L/z0q992D6CP6DtU6fCn96/1OSfQgN2hD+kmFmN
tfXfv7b2jwcurYY/V1sK+wDb37+YCIDMWOSIP7NDUE8+md6/eRpwkYMbiz/5
eq6JChjdv6C2QDGOR40/zXajmM6a2r/IUhHRmHOPP2T8hhXImte/ePdwuNHP
kD9qq1gTHHXUv4xFWQjX5ZE/4DERxeqv0b/xaQzQbBOTPy8E2fRDKM6/Vo6/
lwJBlD/c5Qy+urrJv7uycl+YbpU/wTB+i8b/xb8g1yUnLpyWP5N4p+kC3cK/
Efgbl6O1lz+gtVUcY2PAvwIZEgcZz5g/s6cKkeqOvL/zOQh3juiZP6GxAKXG
9Li/5Fr+5gMCmz8THInZZN+1vyZSv84JM5w/iS0zpawFs79oSYC2D2SdP3+0
UK5hmbC/qkBBnhWVnj/tlAIkzxCtv+w3AoYbxp8/5Digda2Hqb8oupmtyHig
PzSAWV3wi6a/W1gymIMOoT8sz65Zjvijv472yoI+pKE/tF7PXIm9ob/AlGNt
+TmiPzZywzUdm5+/vNhqWjPKoj+5z/JztFicv7gcckdtWqM/iwAycip8mb+0
YHk0p+qjP1hZ6JJg95a/sKSAIeF6pD9W5uh8YL6UvyMMMgI=
      "]]}}, {{}, {}, 
    {RGBColor[1, 0, 0], LineBox[CompressedData["
1:eJwBUQKu/SFib1JlAgAAACQAAAACAAAApXyA5bcWMz4nMQgIZzOOvp5aUexY
glE/d1vNmLGrq7/uXXqJVoJhPwuGs9MZBry/lt8OWFWCcT9aMbs1UmDNvyoR
40AsQXY/D9CIGXA/07++QrcpAwB7P9NuKteEf9e/UnSLEtq+fz+Riq7AMcra
v/PSr33YPoI/2px15SER3b/U5J9CA3aEP7ofwB1rTt6/tvaPBy6thj+Vegg5
Wbbev5gIgMxY5Ig//6amXSFL3r95GnCRgxuLP5wgYSl1C92/oLZAMY5HjT+7
rK+TvAHbv8hSEdGYc48/fzjHIXUz2L9493C40c+QP5Oz2T02CdW/jEVZCNfl
kT/KC7IqyCXSv/FpDNBsE5M/pExzqF3mzr9Wjr+XAkGUPwLAP1ocWMq/u7Jy
X5hulT8BXBPLwIPGvyDXJScunJY/UojooVhMw78R+BuXo7WXP6kCLLGowsC/
AhkSBxnPmD+mu3j5TTK9v/M5CHeO6Jk/7dgk+iSBub/kWv7mAwKbP0qcvl84
WLa/JlK/zgkznD+phuXsnmyzv2hJgLYPZJ0/85NOslHxsL+qQEGeFZWeP3zZ
mLByp62/7DcChhvGnz9eUbjiDwmqvyi6ma3IeKA/iM5c8K/7pr9bWDKYgw6h
PzKzk8lXWaS/jvbKgj6koT+3OGsfmhGiv8CUY235OaI/2NZXqMcWoL+82Gpa
M8qiP701luJA2Zy/uBxyR21aoz+BdO8wTO2Zv7RgeTSn6qM/XD6AezJbl7+w
pIAh4XqkP0yQYL2sFpW/C2whtQ==
      "]]}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  ImageSize->{410., Automatic},
  PlotRange->{{0, 0.04}, {-0.498450152539685, 0.}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output"]
}, Open  ]],

Cell["Looks good!?", "Text"],

Cell[BoxData[""], "Input"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eccentricity", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"param", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MagnetRadius", "\[Rule]", 
      RowBox[{"5", " ", "mm"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"MagnetLength", "\[Rule]", 
      RowBox[{"10", " ", "mm"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Magnetisation", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CalculateCoilParams", "@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CoilRadius", " ", "\[Rule]", 
         RowBox[{"7", " ", "mm"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"CoilLength", "\[Rule]", " ", 
         RowBox[{"10", "mm"}]}], ",", 
        StyleBox[
         RowBox[{" ", 
          StyleBox[" ", "Text",
           FontWeight->"Plain"]}]], "\[IndentingNewLine]", 
        RowBox[{"Current", "\[Rule]", 
         RowBox[{"3", "amps"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WireRadius", "\[Rule]", 
         RowBox[{"0.1", "mm"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WireCoating", "\[Rule]", 
         RowBox[{"0", "mm"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"CoilResistance", "\[Rule]", 
         RowBox[{"8", "ohms"}]}]}], 
       StyleBox["\[IndentingNewLine]", "Text",
        FontWeight->"Plain"], 
       StyleBox["}", "Text",
        FontWeight->"Plain"]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"IntegrationPrecision", "->", "3"}]}], 
    StyleBox["\[IndentingNewLine]", "Text",
     FontWeight->"Plain"], 
    StyleBox["}", "Text",
     FontWeight->"Plain"]}]}], 
  StyleBox[";", "Text",
   FontWeight->"Plain"]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"MagnetCoilForce", "@", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"param", ",", 
         RowBox[{"Displacement", "\[Rule]", "x"}], ",", 
         RowBox[{"Eccentricity", "\[Rule]", 
          RowBox[{"0", "mm"}]}]}], "}"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"0", "mm"}], ",", 
       RowBox[{"30", "mm"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"MagnetCoilForce", "@", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"param", ",", 
         RowBox[{"Displacement", "\[Rule]", "x"}], ",", 
         RowBox[{"Eccentricity", "\[Rule]", 
          RowBox[{"0.1", "mm"}]}]}], "}"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"0", "mm"}], ",", 
       RowBox[{"30", "mm"}]}], "}"}]}], "]"}]}], "}"}]], "Input"],

Cell[BoxData["$Aborted"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"MagnetCoilForce", "@", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"param", ",", 
       RowBox[{"Displacement", "\[Rule]", 
        RowBox[{"7.5", "mm"}]}], ",", 
       RowBox[{"Eccentricity", "\[Rule]", "x"}]}], " ", "}"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"0", "mm"}], ",", 
     RowBox[{"2", "mm"}]}], "}"}], ",", 
   RowBox[{"MaxRecursion", "\[Rule]", "1"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "10"}]}], "]"}]], "Input"],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], 
    LineBox[{{2.2222222222222221`*^-10, 3.69989491998207}, {
     0.00010686726654166551`, 3.5728931567648243`}, {0.00021373431086110878`, 
     3.536200170101285}, {0.0004454465549305497, 3.380827491899662}, {
     0.0006618036210972117, 3.25394602670622}, {0.0008739166204722058, 
     3.145709533847406}, {0.0009889621978749802, 3.088386238696968}, {
     0.0011040077752777545`, 3.0466898074636464`}, {0.0012113757637291392`, 
     3.0086027962904014`}, {0.001318743752180524, 2.970436011495333}, {
     0.001435100818347186, 2.9368603201813914`}, {0.001551457884513848, 
     2.906606762174575}, {0.001665692917284676, 2.88133417461418}, {
     0.001779927950055504, 2.860498074726577}, {0.0018899638639166408`, 
     2.8559020131668116`}, {0.0019999997777777776`, 2.83177904578161}}]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 3.},
  PlotRange->{{0., 0.002}, {2.83177904578161, 3.69989491998207}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output"]
}, Open  ]],

Cell["Old:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"MagnetCoilForce", "@", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"param", ",", 
       RowBox[{"Displacement", "\[Rule]", 
        RowBox[{"7.5", "mm"}]}], ",", 
       RowBox[{"Eccentricity", "\[Rule]", "x"}]}], " ", "}"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"0", "mm"}], ",", 
     RowBox[{"2", "mm"}]}], "}"}], ",", 
   RowBox[{"MaxRecursion", "\[Rule]", "1"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "10"}]}], "]"}]], "Input"],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], 
    LineBox[{{2.2222222222222221`*^-10, 3.699945660820616}, {
     0.00010686726654166551`, 3.6892591947068727`}, {0.00021373431086110878`, 
     3.547079975740059}, {0.0004454465549305497, 3.4010656117908855`}, {
     0.0005536250880138808, 3.34101907966999}, {0.0006618036210972117, 
     3.2855102726969108`}, {0.0007678601207847088, 3.236921039776326}, {
     0.0008739166204722058, 3.1908245625633476`}, {0.0009889621978749802, 
     3.156125626576369}, {0.0011040077752777545`, 3.1092434986093735`}, {
     0.0012113757637291392`, 3.0758839295366722`}, {0.001318743752180524, 
     3.052207824746029}, {0.001435100818347186, 3.029013996625117}, {
     0.001551457884513848, 3.012061734308791}, {0.001665692917284676, 
     2.969529325811507}, {0.001779927950055504, 2.9948834024941817`}, {
     0.0018899638639166408`, 2.9779671815311066`}, {0.0019999997777777776`, 
     2.9991938589679314`}}]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 3.},
  PlotRange->{{0., 0.002}, {2.969529325811507, 3.699945660820616}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output"]
}, Open  ]]
}, Open  ]]
},
Evaluator->"2nd",
WindowSize->{1276, 756},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
CellContext->Notebook,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (November 13, \
2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 248, 7, 43, "Input"],
Cell[818, 31, 66, 0, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[921, 36, 24, 0, 67, "Section"],
Cell[CellGroupData[{
Cell[970, 40, 5165, 121, 583, "Input"],
Cell[6138, 163, 216, 5, 27, "Output"],
Cell[6357, 170, 371, 8, 27, "Output"],
Cell[6731, 180, 329, 7, 27, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7109, 193, 63, 2, 67, "Section"],
Cell[7175, 197, 173, 4, 41, "Text"],
Cell[7351, 203, 1053, 22, 223, "Input"],
Cell[CellGroupData[{
Cell[8429, 229, 1285, 29, 238, "Input"],
Cell[9717, 260, 54, 0, 20, "Print"],
Cell[9774, 262, 130, 3, 27, "Output"],
Cell[9907, 267, 113, 1, 20, "Print"],
Cell[10023, 270, 130, 3, 27, "Output"],
Cell[10156, 275, 107, 1, 20, "Print"],
Cell[10266, 278, 108, 2, 27, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10423, 286, 53, 0, 67, "Section"],
Cell[CellGroupData[{
Cell[10501, 290, 31, 0, 34, "Subsection"],
Cell[10535, 292, 1388, 30, 253, "Input"],
Cell[11926, 324, 1609, 51, 66, "Input"],
Cell[13538, 377, 2247, 58, 193, "Input"],
Cell[CellGroupData[{
Cell[15810, 439, 893, 26, 58, "Input"],
Cell[16706, 467, 62, 1, 27, "Output"],
Cell[16771, 470, 63, 1, 27, "Output"],
Cell[16837, 473, 63, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16937, 479, 2003, 54, 103, "Input"],
Cell[18943, 535, 3059, 58, 217, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22051, 599, 32, 0, 34, "Subsection"],
Cell[22086, 601, 1738, 37, 313, "Input"],
Cell[23827, 640, 4819, 122, 328, "Input"],
Cell[CellGroupData[{
Cell[28671, 766, 1163, 31, 133, "Input"],
Cell[29837, 799, 72, 0, 20, "Print"],
Cell[29912, 801, 127, 3, 27, "Output"],
Cell[30042, 806, 131, 3, 27, "Output"],
Cell[30176, 811, 88, 1, 20, "Print"],
Cell[30267, 814, 130, 3, 27, "Output"],
Cell[30400, 819, 132, 3, 27, "Output"],
Cell[30535, 824, 130, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30702, 832, 1977, 52, 118, "Input"],
Cell[32682, 886, 3036, 58, 261, "Output"]
}, Open  ]],
Cell[35733, 947, 28, 0, 26, "Text"],
Cell[35764, 949, 26, 0, 27, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35839, 955, 31, 0, 67, "Section"],
Cell[35873, 957, 1628, 39, 223, "Input"],
Cell[CellGroupData[{
Cell[37526, 1000, 975, 28, 43, "Input"],
Cell[38504, 1030, 35, 0, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38576, 1035, 547, 15, 27, "Input"],
Cell[39126, 1052, 1118, 21, 228, "Output"]
}, Open  ]],
Cell[40259, 1076, 20, 0, 26, "Text"],
Cell[CellGroupData[{
Cell[40304, 1080, 547, 15, 27, "Input"],
Cell[40854, 1097, 1231, 23, 230, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
